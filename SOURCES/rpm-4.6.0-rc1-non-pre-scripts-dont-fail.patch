From 2c23eefbd7a8468ea9f493218f97320872db562f Mon Sep 17 00:00:00 2001
From: unknown author <cooker@mandrivalinux.org>
Date: Mon, 5 Jan 2009 13:29:57 +0000
Subject: [PATCH 02/36] non pre scripts dont fail

---
 lib/psm.c |   23 ++++++++---------------
 1 files changed, 8 insertions(+), 15 deletions(-)

diff --git a/lib/psm.c b/lib/psm.c
index 48b4d34..3a9dd70 100644
--- a/lib/psm.c
+++ b/lib/psm.c
@@ -1273,16 +1273,14 @@ rpmRC rpmpsmStage(rpmpsm psm, pkgStage stage)
 
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_NOTRIGGERUN)) {
 		/* Run triggers in this package other package(s) set off. */
-		rc = rpmpsmNext(psm, PSM_IMMED_TRIGGERS);
-		if (rc) break;
+		rpmpsmNext(psm, PSM_IMMED_TRIGGERS);
 
 		/* Run triggers in other package(s) this package sets off. */
-		rc = rpmpsmNext(psm, PSM_TRIGGERS);
-		if (rc) break;
+		rpmpsmNext(psm, PSM_TRIGGERS);
 	    }
 
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_NOPREUN))
-		rc = rpmpsmNext(psm, PSM_SCRIPT);
+		rpmpsmNext(psm, PSM_SCRIPT);
 	}
 	break;
     case PSM_PROCESS:
@@ -1420,17 +1418,14 @@ rpmRC rpmpsmStage(rpmpsm psm, pkgStage stage)
 	    psm->countCorrection = 0;
 
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_NOPOST)) {
-		rc = rpmpsmNext(psm, PSM_SCRIPT);
-		if (rc) break;
+		rpmpsmNext(psm, PSM_SCRIPT);
 	    }
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_NOTRIGGERIN)) {
 		/* Run triggers in other package(s) this package sets off. */
-		rc = rpmpsmNext(psm, PSM_TRIGGERS);
-		if (rc) break;
+		rpmpsmNext(psm, PSM_TRIGGERS);
 
 		/* Run triggers in this package other package(s) set off. */
-		rc = rpmpsmNext(psm, PSM_IMMED_TRIGGERS);
-		if (rc) break;
+		rpmpsmNext(psm, PSM_IMMED_TRIGGERS);
 	    }
 
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_APPLYONLY))
@@ -1445,14 +1440,12 @@ rpmRC rpmpsmStage(rpmpsm psm, pkgStage stage)
 	    psm->countCorrection = -1;
 
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_NOPOSTUN)) {
-		rc = rpmpsmNext(psm, PSM_SCRIPT);
-		if (rc) break;
+		rpmpsmNext(psm, PSM_SCRIPT);
 	    }
 
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_NOTRIGGERPOSTUN)) {
 		/* Run triggers in other package(s) this package sets off. */
-		rc = rpmpsmNext(psm, PSM_TRIGGERS);
-		if (rc) break;
+		rpmpsmNext(psm, PSM_TRIGGERS);
 	    }
 
 	    if (!(rpmtsFlags(ts) & RPMTRANS_FLAG_APPLYONLY))
-- 
1.6.4.4

