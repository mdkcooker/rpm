--- rpm-4.12.0.1/lib/fsm.c.orig	2014-12-11 14:14:21.275250564 -0500
+++ rpm-4.12.0.1/lib/fsm.c	2014-12-11 14:19:28.526662128 -0500
@@ -215,7 +215,12 @@ static int expandRegular(rpmfi fi, const
     FD_t wfd = NULL;
     int rc = 0;
 
-    wfd = Fopen(dest, "w.ufdio");
+    /* Create the file with 000 permissions. */
+    {
+	mode_t old_umask = umask(0777);
+	wfd = Fopen(dest, "w.ufdio");
+	umask(old_umask);
+    }
     if (Ferror(wfd)) {
 	rc = RPMERR_OPEN_FAILED;
 	goto exit;
